<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>До конца рабства</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      font-family: Arial, sans-serif;
      color: white;
    }

    .card {
      background: rgba(255,255,255,0.15);
      padding: 40px 60px;
      border-radius: 24px;
      box-shadow: 0 0 25px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .photo {
      width: 200px;
      height: 200px;
      object-fit: cover;
      border-radius: 50%;
      margin-bottom: 20px;
      border: 3px solid rgba(255,255,255,0.7);
      transition: transform 0.3s linear;
    }

    .rotate {
      animation: spin 4s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    h1 {
      margin: 10px 0;
      font-size: 32px;
      text-align: center;
    }

    #timer {
      font-size: 28px;
      margin: 20px 0;
      font-weight: bold;
    }

    .pigeon {
      width: 100px;
      height: auto;
      cursor: pointer;
      margin-top: 15px;
      transition: transform 0.2s;
    }

    .pigeon:hover {
      transform: scale(1.1);
    }

    .flap {
      animation: flap 0.5s infinite alternate;
    }

    @keyframes flap {
      from { transform: rotate(-10deg) scale(1.05); }
      to   { transform: rotate(10deg)  scale(0.95); }
    }
  </style>
</head>
<body>
  <div class="card">
    <img src="Nazar.png" alt="Nazar" class="photo" id="photo">
    <h1>До конца рабства</h1>
    <div id="timer"></div>
    <img src="pigeon.png" alt="Голубь" class="pigeon" id="pigeon" onclick="playSong()">
  </div>

  <!-- Музыка -->
  <audio id="song" src="Older.mp3"></audio>

  <script>
    // === ТАЙМЕР ===
    function getRemainingWorkTime() {
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      const lastDay = new Date(year, month + 1, 0);

      let remainingMs = 0;
      for (let d = new Date(now); d <= lastDay; d.setDate(d.getDate() + 1)) {
        if (d.getDay() >= 1 && d.getDay() <= 5) { // пн-пт
          let start = new Date(d);
          start.setHours(9, 0, 0, 0);
          let end = new Date(d);
          end.setHours(17, 0, 0, 0);

          if (d.toDateString() === now.toDateString()) {
            if (now < start) {
              remainingMs += (end - start);
            } else if (now >= start && now < end) {
              remainingMs += (end - now);
            }
          } else {
            remainingMs += (end - start);
          }
        }
      }
      return remainingMs;
    }

    function updateTimer() {
      let ms = getRemainingWorkTime();

      let seconds = Math.floor(ms / 1000);
      let days = Math.floor(seconds / (3600 * 8));
      seconds %= 3600 * 8;

      let hours = Math.floor(seconds / 3600);
      seconds %= 3600;

      let minutes = Math.floor(seconds / 60);
      seconds %= 60;

      document.getElementById("timer").textContent =
        days + " Д " +
        hours.toString().padStart(2, '0') + " Ч " +
        minutes.toString().padStart(2, '0') + " М " +
        seconds.toString().padStart(2, '0') + " С";
    }

    setInterval(updateTimer, 1000);
    updateTimer();

    // === МУЗЫКА + АНИМАЦИИ ===
    function playSong() {
      const audio = document.getElementById("song");
      const pigeon = document.getElementById("pigeon");
      const photo = document.getElementById("photo");

      audio.volume = 0.3; // громкость тише

      if (audio.paused) {
        audio.play();
        pigeon.classList.add("flap");
        photo.classList.add("rotate");
      } else {
        audio.pause();
        audio.currentTime = 0;
        pigeon.classList.remove("flap");
        photo.classList.remove("rotate");
      }
    }
  </script>
</body>
</html>
